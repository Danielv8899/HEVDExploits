#pragma once
#include <windows.h>
#include <Psapi.h>
#include <map>
#include <vector>
#include <string>

#define HEVD_IOCTL_BUFFER_OVERFLOW_STACK 0x222003
#define HEVD_IOCTL_ARBITRARY_WRITE 0x22200B

typedef unsigned __int64 QWORD;
typedef std::map<std::string, std::vector<BYTE >> OPS;
typedef std::map<std::string, QWORD> GADGETS;

typedef struct _RTL_PROCESS_MODULE_INFORMATION
{
    HANDLE Section;
    PVOID MappedBase;
    PVOID ImageBase;
    ULONG ImageSize;
    ULONG Flags;
    USHORT LoadOrderIndex;
    USHORT InitOrderIndex;
    USHORT LoadCount;
    USHORT OffsetToFileName;
    UCHAR FullPathName[256];
} RTL_PROCESS_MODULE_INFORMATION, * PRTL_PROCESS_MODULE_INFORMATION;

typedef struct _RTL_PROCESS_MODULES
{
    UINT32 NumberOfModules;
    RTL_PROCESS_MODULE_INFORMATION Modules[1];
} RTL_PROCESS_MODULES, * PRTL_PROCESS_MODULES;

union {
    DWORD pidI;
    BYTE pidC[4];
} pid;
